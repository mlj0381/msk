<div id="store_info">
    <input type="hidden" name="store[store_id]" value="<{$extra.store.store_id}>" class="form-control">
    <h4>店铺信息</h4>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>店铺类型：
        </label>
        <div class="col-xs-4">
            <!-- <{input type=select required="true" name="store[store_type]" rows=$extra.page_setting.store valueColumn="id" labelColumn="label" value=$extra.store.store_type}> -->
            <input type="text" class="form-control" disabled name="store[store_type]" value="<{$extra.store.store_type}>">
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>店铺名称：
        </label>
        <div class="col-xs-4">
            <input name="store[store_name]" value="<{$extra.store.store_name}>" class="form-control" required="true" />
            <span class="msgTip" data-message="error"></span>
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>店铺logo：
        </label>
        <div class="col-xs-4">
            <{input type="imageupload" tag="图片上传" name="store[logo]" value=$extra.store.logo required='true' accept="jpg|png|gif" }>
            <span class="msgTip" data-message="error">不能为空</span>
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>经营品牌：
        </label>
        <div class="col-xs-4">
            <button type="button" class="btn btn-md btn-default brand_add_btn" data-toggle="modal" data-target=".brand_add_modal" href="<{link app=seller ctl=site_brand act=brand_add}>"><i class="icon-plus"></i> 添加品牌</button>
            <div class="brand_list" data-list="brand_list">
                <{foreach from=$extra.brand item=item}>
                    <span class="brand_item"><{$item.brand_name}> <i class="icon-remove" data-id="<{$item.brand_id}>"></i></span>
                <{/foreach}>
            </div>
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>经营商品类别：
        </label>
        <div class="col-xs-4">
            <button type="button" class="btn btn-md btn-default cat_add_btn" data-toggle="modal" data-target=".category_add_modal" href="<{link app=seller ctl=site_cat act=add_cat}>"><i class="icon-plus"></i> 添加分类</button>
        </div>
    </div>
    <!-- 品牌添加模态框 -->
    <div class="modal fade brand_add_modal" id="brand_add_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">

            </div>
        </div>
    </div>
    
    <!-- 商品类目添加模态框 -->
    <div class="modal fade category_add_modal" id="category_add_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">

            </div>
        </div>
    </div>

</div>


<script type="text/javascript">

    $(function(){

        //创建品牌
        $('#brand_add_modal').on('click','.brand_save_btn',function(){
            var brand = $.trim($('.brand_name').val());
            var brand_html ='<span class="brand_item">'+brand+' <i class="icon-remove"></i></span>';
            if(brand != '' && brand != null && brand != undefined){
                $('.brand_list').append(brand_html);
            }
            $("#brand_add_modal").modal('hide');
        })

        //移除品牌
        $('.brand_list').on('click','.icon-remove',function(){
            if(confirm("您真的要删除吗？")){
                var brandId = $(this).attr('data-id');
                if(brandId <= 0) {
                    alert('删除失败');
                    return false;
                }
                var _self = $(this);
                var url = '<{link app=seller ctl=site_brand act=remove}>';
                $.post(url, {'brand_id' : brandId}, function(re){
                    if(re.success){
                        _self.parent('.brand_item').remove();
                    }else{
                        alert('删除失败');
                    }
                });

            }  
        });
    
        $('#brand_add_modal').on('shown.bs.modal', function () {
            $.VMC.init();  //重新绑定图片上传事件
        });
        $("#brand_add_modal").on("hidden.bs.modal", function() {  
            $(this).removeData("bs.modal");  //关闭时清空数据
        }); 

        $('[data-toggle="tooltip"]').tooltip();
    })

</script>
