<div id="store_info">
    <input type="hidden" name="store[store_id]" value="<{$extra.store.store_id}>" class="form-control">
    <h4>店铺信息</h4>

    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>店铺类型：
        </label>

        <div class="col-xs-4">
            <!-- <{input type=select required="true" name="store[store_type]" rows=$extra.page_setting.store valueColumn="id" labelColumn="label" value=$extra.store.store_type}> -->
            <input type="text" class="form-control" disabled name="store[store_type]"
                   value="<{$extra.store.store_type}>">
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>店铺名称：
        </label>

        <div class="col-xs-4">
            <input name="store[store_name]" value="<{$extra.store.store_name}>" class="form-control" required="true"/>
            <span class="msgTip" data-message="error"></span>
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>店铺logo：
        </label>

        <div class="col-xs-4">
            <{input type="imageupload" tag="图片上传" name="store[logo]" value=$extra.store.logo required='true'
            accept="jpg|png|gif" }>
            <span class="msgTip" data-message="error">不能为空</span>
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>经营品牌：
        </label>

        <div class="col-xs-4">
            <button type="button" class="btn btn-md btn-default brand_add_btn" data-toggle="modal"
                    data-target=".brand_add_modal" href="<{link app=seller ctl=site_passport act=add_brand}>"><i
                    class="icon-plus"></i> 添加品牌
            </button>
            <div class="brand_list" data-list="brand_list">
                <{foreach from=$extra.brand item=item}>
                <span class="brand_item"><{$item.brand_name}> <i class="icon-remove"
                                                                 data-id="<{$item.brand_id}>"></i></span>
                <{/foreach}>
            </div>
        </div>
    </div>
    <div class="form-group">
        <label class="col-xs-2 control-label">
            <span class="text-danger">*</span>经营商品类别：
        </label>

        <div class="col-xs-10">
            <button type="button" class="btn btn-md btn-default cat_add_btn"
                    href="<{link app=seller ctl=site_passport act=add_cat}>"><i class="icon-plus"></i> 选择分类
            </button>
            <div class="cat_wrapbox">
                <p class="cat_header"><span class="icon-list"></span> 产品分类目录</p>
                <table class="cat_tree table-hover">
                    <tr>
                    <tr>
                        <th width="20%">编码</th>
                        <th width="50%">名称</th>
                        <th width="30%">标准资质</th>
                    </tr>
                    </tr>
                    <tr data-treeId="01" data-catName="鸡产品">
                        <td><span class="arrow icon-caret-right"></span>01</td>
                        <td>鸡产品</td>
                        <td></td>
                    </tr>
                    <tr data-treeId="01-1" data-catName="白条鸡">
                        <td><span class="arrow icon-caret-right"></span>1</td>
                        <td><input type="checkbox" name="cat_id" value="1">白条鸡</td>
                        <td>
                            <!--data-toggle="modal" data-target=".category_add_modal"-->
                            <span class="apt_tag active apt_stock-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_stock args1=1}>"
                                  data-tagId="1" title="原种">原
                                <input type="hidden" name="apt_stock" value="0"/>
                            </span>
                            <span class="apt_tag active apt_prove-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_prove args1=1}>"
                                  data-tagId="2" title="原种种源标准指标">种
                                <input type="hidden" name="apt_prove" value="0"/>
                            </span>
                            <span class="apt_tag active apt_raise-1" data-toggle="modal"
                                  data-target=".category_add_modal"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_raise args1=1}>"
                                  data-tagId="3"
                                  title="原种饲养标准指标">饲
                                <input type="hidden" name="apt_raise" value="0" />
                            </span>
                            <span class="apt_tag active apt_technology-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_technology args1=1}>"
                                  data-tagId="4"
                                  title="产品加工技术标准指标">技
                                <input type="hidden" name="apt_technology" value="0" />
                            </span>
                            <span class="apt_tag active apt_quality-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_quality args1=1}>"
                                  data-tagId="5"
                                  title="产品加工质量标准指标">质
                                <input type="hidden" name="apt_quality" value="0" />
                            </span>
                            <span class="apt_tag active apt_common-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_common args1=1}>"
                                  data-tagId="6"
                                  title="产品通用质量标准指标">通
                                <input type="hidden" name="apt_common" value="0" />
                            </span>
                            <span class="apt_tag active apt_safety-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_safety args1=1}>"
                                  data-tagId="7"
                                  title="产品安全标准指标">安
                                <input type="hidden" name="apt_safety" value="0" />
                            </span>
                            <span class="apt_tag active apt_transport-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_transport args1=1}>"
                                  data-tagId="8"
                                  title="储存运输标准指标">运
                                <input type="hidden" name="apt_transport" value="0" />
                            </span>
                            <span class="apt_tag active apt_pack-1"
                                  href="<{link app=seller ctl=site_passport act=display_type args0=apt_pack args1=1}>"
                                  data-tagId="9"
                                  title="包装标准指标">包
                                <input type="hidden" name="apt_pack" value="0" />
                            </span>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <!-- 品牌添加模态框 -->
    <div class="modal fade brand_add_modal" id="brand_add_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">

            </div>
        </div>
    </div>

    <!-- 商品类目添加模态框 -->
    <div class="modal fade category_add_modal" id="category_add_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">

            </div>
        </div>
    </div>

</div>


<script type="text/javascript">

    $(function () {

        //创建品牌
        $('#brand_add_modal').on('click', '.brand_save_btn', function () {
            var brand = $.trim($('.brand_name').val());
            var brand_html = '<span class="brand_item">' + brand + ' <i class="icon-remove"></i></span>';
            if (brand != '' && brand != null && brand != undefined) {
                $('.brand_list').append(brand_html);
            }
            $("#brand_add_modal").modal('hide');
        })

        //移除品牌
        $('.brand_list').on('click', '.icon-remove', function () {
            if (confirm("您真的要删除吗？")) {
                var brandId = $(this).attr('data-id');
                if (brandId <= 0) {
                    alert('删除失败');
                    return false;
                }
                var _self = $(this);
                var url = '<{link app=seller ctl=site_brand act=remove}>';
                $.post(url, {'brand_id': brandId}, function (re) {
                    if (re.success) {
                        _self.parent('.brand_item').remove();
                    } else {
                        alert('删除失败');
                    }
                });

            }
        });

        $('#brand_add_modal').on('shown.bs.modal', function () {
            $.VMC.init();  //重新绑定图片上传事件
        });
        $("#brand_add_modal").on("hidden.bs.modal", function () {
            $(this).removeData("bs.modal");  //关闭时清空数据
        });

        $('[data-toggle="tooltip"]').tooltip();

        /**
         * 产品档案卡信息确定
         */

        $('.cat_tree input[type="checkbox"]').click(function () {
            var spanList = $(this).closest('tr').find('span.apt_tag');
            if ($(this).prop('checked')) {
                spanList.attr('data-toggle', 'modal');
                spanList.attr('data-target', '.category_add_modal');
            } else {
                spanList.removeAttr('data-toggle');
                spanList.removeAttr('data-target');
            }
        });

        $('.modal-footer button').click(function(){
            alert($(this).attr('id'));
        });
        //end 产品档案卡信息确定

        //经营商品类别添加
        $(".cat_add_btn").on('click', function () {
            $(".cat_wrapbox").slideToggle();
        });
        $('#category_add_modal').on('shown.bs.modal', function () {
            var readonly = $(this).find('.modal-body').attr('data-readonly');
            if (readonly == "readonly") {
                $(this).find('input,textarea').attr('readonly', 'readonly');
            }
        });
        $("#category_add_modal").on("hidden.bs.modal", function () {
            $(this).removeData("bs.modal");  //关闭时清空数据
        });


    });

</script>
