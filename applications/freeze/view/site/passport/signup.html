<div class="reg_progress clearfix">
    <ol>
        <li class="active">
            <span><i>1</i>冻品管家注册</span>
        </li>
        <li>
            <span><i>2</i>冻品管家基本信息注册</span>
        </li>
    </ol>
</div>
<div class="passport-signup-container seller_regbox">
    <div class="panel panel-default signup-panel">
        <div class="panel-body">
            <form id="member_signup_form" data-module="validator" class="form-horizontal" action="<{link app=seller ctl=site_passport act=signup args0=1}>" method="post">
                <!-- 登陆后跳转地址 -->
                <input type="hidden" name="forward" value="<{$forward}>">
                <div class="form-group">
                    <label for="input_login_name" class="col-md-2 control-label"><span class="text-danger">*</span>登录账号：</label>
                    <div class="col-md-4">
                        <input type="text" required="true" autocomplete='off' name="pam_account[login_name]" class="form-control" id="input_login_name" placeholder="手机号/邮箱/用户名" required="true" format="username|mobile|email" remote="<{link app=seller ctl=site_passport act=check_login_name}>" data="#input_login_password">
                        <span class="msgTip" data-message="format">账号仅支持手机号、邮箱、用户名(支持6-18位字母、数字、下划线组合)</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="input_login_password" class="col-md-2 control-label"><span class="text-danger">*</span>登录密码：</label>
                    <div class="col-md-4">
                        <input type="password" required="true" name="pam_account[login_password]" class="form-control" id="input_login_password" placeholder="必须是6-20位，只能包含字母、数字、下划线" required="true" format="password">
                        <span class="msgTip" data-message="format">必须是6-20位，只能包含字母、数字、下划线</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="input_psw_confirm" class="col-md-2 control-label"><span class="text-danger">*</span>确认密码：</label>
                    <div class="col-md-4">
                        <input type="password" required="true" format="password" name="pam_account[psw_confirm]" class="form-control" id="input_psw_confirm" placeholder="再次输入登录密码" equalTo="#input_login_password">
                        <span class="msgTip" data-message="error">两次密码输入不一致</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="input_psw_confirm" class="col-md-2 control-label"><span class="text-danger">*</span>验证手机：</label>
                    <div class="col-md-4">
                        <input type="text" required="true" name="pam_account[mobile]" class="form-control" id="input_mobile" required="true" format="mobile" remote="<{link app=seller ctl=site_passport act=is_exists_mobile}>">
                        <span class="msgTip" data-message="error">请输入正确的手机号码</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="input_psw_confirm" class="col-md-2 control-label"><span class="text-danger">*</span>短信验证码：</label>
                    <div class="col-md-2">
                        <input type="text" required="true" name="smscode" class="form-control" id="input_vcode" required="true" >

                        <span class="msgTip" data-message="error"></span>
                    </div>
                    <div class="col-md-2">
                        <div class="mobile-vcode">
                            <button type="button" data-loading-text="正在发送..." class="btn btn-default">获取短信验证码</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="input_psw_confirm" class="col-md-2 control-label"></label>
                    <div class="col-md-4">
                        <input type="checkbox" name="treaty" checked="checked"> 我已阅读并同意
                        <a href="#" class="text-danger" data-toggle="modal" data-target="#accordModal">《美侍客用户注册协议》</a>
                        <a href="#" class="text-danger" data-toggle="modal" data-target="#accordModal">《美侍客服务条款》</a>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-4">
                        <button type="submit" data-loading-text="正在提交..." class="btn btn-danger">立即注册</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>


<!-- 注册协议Modal -->
<div class="modal fade" id="accordModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">美侍客用户注册协议/美侍客服务条款</h4>
            </div>
            <div class="modal-body">
                <p>注册协议内容</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">我知道了</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



<script>
    /*
     * 会员注册脚本
     */

    void function(signup_form) {

        /*var alert_timer = 0;
         var _alert_error = function(msg) {
         signup_form.find('.alert-error').remove();
         signup_form.append($('<div class="alert alert-danger">' + msg + '</div>'));
         alert_timer = setTimeout(function() {
         clearTimeout(alert_timer);
         signup_form.find('.alert-danger').fadeOut('fast', function() {
         $(this).remove();
         });
         }, 3000);
         }

         */
        //获得短信验证码
        var _cutdown_sms = function(btn) {
            btn.addClass('disabled');
            var cutdown = 120,
                    btn_o_text = btn.text(),
                    timer =
                            setInterval((function() {
                                btn.text('短信已发送,' + (cutdown--) + '秒后可重试');
                                if (cutdown < 1) {
                                    clearInterval(timer);
                                    btn.text(btn_o_text).removeClass('disabled');
                                }
                                return arguments.callee;
                            })(), 1000);
        };

        signup_form.find('.mobile-vcode button').on('click', function(e) {
            var btn = $(this);
            if (btn.hasClass('disabled')) return;
            btn.addClass('disabled');
            $.post('<{link app=seller ctl=site_passport act=send_vcode_sms}>', {
                mobile: $('#input_mobile').val()
            }, function(re) {
                if (re && re.error) {//input_vcode
                    btn.removeClass('disabled');

                    alert(re.error);
                }
                if (re && re.success) {
                    $("#input_vcode").val(re.redirect);
                    _cutdown_sms(btn);
                }
            }, 'json');


        });



    }($('#member_signup_form'));
</script>
